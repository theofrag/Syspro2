Syspro project 2 – Φραγκούλης Θεόδωρος – sdi1900207

Αρχικά ο server δημιουργεί τους workers ανάλογα με τα ορίσματα από την γραμμή εντολών.
Ύστερα αφού δημιουργήσει το listening socket και κάνει όλες τις απαραίτητες ενέργειες μέσα σε μια while(1) κάνει accept κάθε σύνδεση που έρχεται, 
εκτυπώνει το όνομα αυτού που συνδέθηκε και εισάγει σε ένα map με κλειδί τον αριθμό του socket ένα mutex. Ο σκοπός του mutex αυτού εξηγείται παρακάτω.

Τέλος δημιουργεί ένα communication thread για κάθε σύνδεση που έρχεται.

Το communication thread αρχικά διαβάζει το όνομα του καταλόγου από τον client.
Ύστερα προσθέτει τα όνοματα των αρχείων μαζί με το socket στην ουρά. 
Τέλος κάνει detach το thread για να ελυθερωθούν οι πόροι του.

Το worker_thread παίρνει ένα όνομα αρχείου από την ουρά, μαζί με το socket επικοινωνίας με τον client.
Ύστερα κατεβάζει το mutex που αντιστοιχεί στο συγκεκριμένο socket ώστε να μην μπορούν άλλοι workers να στείλουν αρχεία στον ίδιο client εκείνη την στιγμή. 
Στην συνέχεια στέλνει στον server το ονομα του αρχείου, το size του αρχείου και τα περιεχόμενα του. 
Τέλος ανεβάζει πάλι τον σεμαφόρο και ελέγχει αν αυτό ήταν το τελευταίο αρχείο που περίμενε ο χρήστης. 
Αν ναι τότε κλείνει το socket ώστε να μπορεί να χρησιμοποιηθεί από άλλον client.

Το μήνυμα που στέλνει ο server στον client είναι το εξής:
Filename\nSizeoffile\nData\n

Αν το αρχείο ήταν το τελευταίο αρχείο που περίμενε ο χρήστης τότε στέλνεται και ένα μήνυμα με σώμα \nCONTERM\n στον χρήστη.

Οι συναρτήσεις char* obtain(pool_t * pool), void initialize(pool_t * pool), void place(pool_t * pool, char* data) είναι 
απο τις διαφάνειες του μαθήματος